# Data Model

This document outlines the core data entities, attributes, and relationships required to support the CS Learning Platform, as defined in the master [PRD.md](PRD.md).

## 1. Entity Relationship Diagram (ERD)

This diagram shows the high-level relationships between the core entities.



---

## 2. Entity Definitions

### 2.1. Core Entities

* **User**
    * **Description:** Represents any individual interacting with the system. Their permissions are defined by their `role`.
    * **Attributes:**
        * `user_id (string)`
        * `name (string)`
        * `email (string)`
        * `role (enum: 'Student', 'Teacher')`

* **Course**
    * **Description:** The main container for all content. Owned by a `Teacher` and enrolled in by `Student`s.
    * **Attributes:**
        * `course_id (string)`
        * `name (string)`
        * `department (string)`
        * `owner_user_id (string)`

* **SourceMaterial**
    * **Description:** A single piece of content (PDF, slide deck, .md file, whitelisted URL) uploaded by a Teacher. This is the corpus for the RAG system.
    * **Attributes:**
        * `material_id (string)`
        * `course_id (string)`
        * `source_type (enum: 'UPLOAD', 'EXTERNAL_URL')`
        * `path_or_url (string)`
        * `indexed_status (enum: 'PENDING', 'INDEXED', 'ERROR')`

* **Topic**
    * **Description:** A granular concept or skill within a course, defined by a Teacher. (e.g., "Recursion", "Big-O Notation").
    * **Attributes:**
        * `topic_id (string)`
        * `course_id (string)`
        * `name (string)`
        * `description (string)`

* **LearningTrajectory**
    * **Description:** A `Teacher`-defined sequence of `Topic`s that represents a logical path through the course material.
    * **Attributes:**
        * `trajectory_id (string)`
        * `course_id (string)`
        * `name (string)`

### 2.2. Relational & Logging Entities

* **CourseEnrollment**
    * **Description:** Links `Student`s to the `Course`s they are taking.
    * **Attributes:**
        * `user_id (string)`
        * `course_id (string)`

* **TrajectoryTopicLink**
    * **Description:** Links `Topic`s to a `LearningTrajectory` and defines their specific `order`.
    * **Attributes:**
        * `trajectory_id (string)`
        * `topic_id (string)`
        * `order (integer)`

* **StudentProgress**
    * **Description:** Tracks a single `Student`'s mastery of a single `Topic`.
    * **Attributes:**
        * `user_id (string)`
        * `topic_id (string)`
        * `status (enum: 'NOT_STARTED', 'IN_PROGRESS', 'MASTERED')`

* **ChatSession**
    * **Description:** A container for a single conversational thread between a `Student` and the bot for a specific `Course`.
    * **Attributes:**
        * `session_id (string)`
        * `user_id (string)`
        * `course_id (string)`
        * `created_at (datetime)`

* **ChatMessage**
    * **Description:** A single message sent by either the `USER` or the `BOT` within a `ChatSession`.
    * **Attributes:**
        * `message_id (string)`
        * `session_id (string)`
        * `timestamp (datetime)`
        * `sender (enum: 'USER', 'BOT')`
        * `content (string)`
        * `is_socratic (boolean)`

* **MessageCitation**
    * **Description:** Links a specific `ChatMessage` (from the bot) to the `SourceMaterial`(s) it used to generate the answer.
    * **Attributes:**
        * `message_id (string)`
        * `material_id (string)`

* **Assessment**
    * **Description:** A quiz, exam, or assignment created by a `Teacher` or generated by a `Student` for practice.
    * **Attributes:**
        * `assessment_id (string)`
        * `course_id (string)`
        * `creator_user_id (string)`
        * `type (enum: 'QUIZ', 'EXAM', 'ASSIGNMENT')`
        * `title (string)`

* **AssessmentTopicLink**
    * **Description:** Links an `Assessment` to the `Topic`(s) it covers.
    * **Attributes:**
        * `assessment_id (string)`
        * `topic_id (string)`